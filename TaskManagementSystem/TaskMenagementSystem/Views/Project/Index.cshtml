@model IEnumerable<Domain.Entities.Project>
@using Domain.Entities

@{
    ViewBag.Title = "Projects";
}

<h2>Projects</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

<form id="projectForm" style="margin:30px auto; width:50%; padding:20px; border-radius:5px; background-color:#d9d9d9; z-index:1000;">
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <h4>Create Project</h4>
        <br />
        <div class="form-group">
            <label class="control-label col-md-2">Name</label>
            <div class="col-md-10">
                <input type="text" class="form-control" name="name"/>
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2">CustomerID</label>
            <div class="col-md-10">
                @Html.DropDownList("CustomerId", null, htmlAttributes: new { @class = "form-control" })
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Create" class="btn btn-default" id="saveProject" />
            </div>
        </div>
    </div>
</form>


<span style="color:red">@ViewBag.ErrorProject</span>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Customer.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DateCreated)
        </th>
        <th>
            Number of tasks
        </th>
        <th>
            @Html.DisplayNameFor(model => model.IsActive)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Customer.Name)
        </td>
        <td>
            @if (item.IsActive == true)
            {
                @Html.ActionLink(item.Name, "Index", "Task", new { id = item.ID }, null)
            }
            else
            {
                @Html.DisplayFor(modelItem => item.Name)
            }
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.DateCreated)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Tasks.Count)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IsActive)
        </td>
        <td>
            @Html.ActionLink("Edit  ", "Edit", new { id = item.ID })

            <form method="post" action="~/Project/Delete/@item.ID" style="display:inline-block">
                <input type="submit" value="Delete" class="btn-link"/>
            </form>
        </td>
    </tr>
}
</table>

@section scripts{
    <script>
        //$("#projectForm").dialog({
        //   // autoOpen: false,
        //    height: 300,
        //    width: 350,
        //    modal: true,
        //}).css({"margin":"30px auto", "width":"50%", "padding":"20px", "border-radius":"5px", "background-color":"#d9d9d9"});





    </script>
}